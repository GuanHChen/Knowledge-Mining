{"title":"Knowledge Mining (EPPS 6323)","markdown":{"yaml":{"title":"Knowledge Mining (EPPS 6323)","subtitle":"Assignment 8","author":"Guan Chen","date":"last-modified","toc":false,"title-block-banner":true},"headingText":"Linear Discriminant Analysis","containsRefs":false,"markdown":"\n\n```{R}\nrequire(ISLR)\nrequire(MASS)\nrequire(descr)\nattach(Smarket)\n\nfreq(Direction)\ntrain = Year<2005\nlda.fit=lda(Direction~Lag1+Lag2,data=Smarket, subset=Year<2005)\nlda.fit\nplot(lda.fit, col=\"dodgerblue\")\nSmarket.2005=subset(Smarket,Year==2005) # Creating subset with 2005 data for prediction\nlda.pred=predict(lda.fit,Smarket.2005)\nnames(lda.pred)\nlda.class=lda.pred$class\nDirection.2005=Smarket$Direction[!train] \ntable(lda.class,Direction.2005) \ndata.frame(lda.pred)[1:5,]\ntable(lda.pred$class,Smarket.2005$Direction)\nmean(lda.pred$class==Smarket.2005$Direction)\n\n\n```\n\nThe best subset selection model will have the smallest training rss.\nThe stepwise selection models will have the smallest test rss. Between the forward and backward models, it will depend on the specific data being modeled. \n\n```{R}\nset.seed(123)\nx <- rnorm(100)\neps <- rnorm(100)\n\ny <- 4 + 9 * x + 2 * x^2 + x^3 + eps\n\nplot(x)\nplot(y)\n\nrequire(leaps)\n\nbest_subset <- regsubsets(y ~ poly(x, 10, raw = T), data = data.frame(y,x, nvmax = 10))\nbic <- summary(best_subset)$bic\ncp <- summary(best_subset)$cp\nadjr2 <- summary(best_subset)$adjr2\n\nplot(bic, type = \"b\", pch = 16, col = \"blue\", \n     xlab = \"Model Number\", ylab = \"BIC Value\", \n     main = \"BIC Values for Different Models\")\nplot(cp, type = \"b\", pch = 16, col = \"blue\", \n     xlab = \"Model Number\", ylab = \"Cp Value\", \n     main = \"Cp Values for Different Models\")\nplot(adjr2, type = \"b\", pch = 16, col = \"blue\", \n     xlab = \"Model Number\", ylab = \"Adjusted R^2 Value\", \n     main = \"Adjusted R^2 Values for Different Models\")\n\nwhich.min(bic)\nwhich.min(cp)\nwhich.max(adjr2)\n\ncoef(best_subset, id = 3)\n```\nThe best model is model 3 which has the lowest BIC value and Cp value. While model 7 has the maximum adjusted R squared value, the R squared plot begins to plateau at model 3, and I suspect overfitting to occur. \n\nThe coefficients for model 3 are 3.97, 8.92, 1.91, and 1.02 for the intercept, B1, B2, and B3 respectively.\n\n```{R}\nfor_subset <- regsubsets(y ~ poly(x, 10, raw = T), data = data.frame(y,x, nvmax = 10), method = \"forward\")\n\nplot(summary(for_subset)$bic, type = \"b\", pch = 16, col = \"blue\", \n     xlab = \"Model Number\", ylab = \"BIC Value\", \n     main = \"BIC Values for Different Models\")\nplot(summary(for_subset)$cp, type = \"b\", pch = 16, col = \"blue\", \n     xlab = \"Model Number\", ylab = \"Cp Value\", \n     main = \"Cp Values for Different Models\")\nplot(summary(for_subset)$adjr2, type = \"b\", pch = 16, col = \"blue\", \n     xlab = \"Model Number\", ylab = \"Adjusted R^2 Value\", \n     main = \"Adjusted R^2 Values for Different Models\")\n\nwhich.min(summary(for_subset)$bic)\nwhich.min(summary(for_subset)$cp)\nwhich.max(summary(for_subset)$adjr2)\n\n\ncoef(for_subset, id = 3)\n```\n\nThe best model is model 3 again with the lowest BIC and Cp values. Model 4 wins the best adjusted R squared value but model 3 has a similar adjusted R squared value according to the plot. \n\nThe coefficients for model 3 are 3.97, 8.92, 1.91, and 1.02 for the intercept, B1, B2, and B3 respectively. \n\n\n\n```{R}\nbac_subset <- regsubsets(y ~ poly(x, 10, raw = T), data = data.frame(y,x, nvmax = 10), method = \"backward\")\n\nplot(summary(bac_subset)$bic, type = \"b\", pch = 16, col = \"blue\", \n     xlab = \"Model Number\", ylab = \"BIC Value\", \n     main = \"BIC Values for Different Models\")\nplot(summary(bac_subset)$cp, type = \"b\", pch = 16, col = \"blue\", \n     xlab = \"Model Number\", ylab = \"Cp Value\", \n     main = \"Cp Values for Different Models\")\nplot(summary(bac_subset)$adjr2, type = \"b\", pch = 16, col = \"blue\", \n     xlab = \"Model Number\", ylab = \"Adjusted R^2 Value\", \n     main = \"Adjusted R^2 Values for Different Models\")\n\nwhich.min(summary(bac_subset)$bic)\nwhich.min(summary(bac_subset)$cp)\nwhich.max(summary(bac_subset)$adjr2)\n\ncoef(bac_subset, id = 3)\n```\n\nUsing the backwards stepwise selection method, model 4 performs the best on all 3 metrics. The coefficients are 3.96, 9.89, 1.97, and 0.17 for the intercept, B1, B2, and B3 respectively. \n\n","srcMarkdownNoYaml":"\n\n```{R}\nrequire(ISLR)\nrequire(MASS)\nrequire(descr)\nattach(Smarket)\n\n## Linear Discriminant Analysis\nfreq(Direction)\ntrain = Year<2005\nlda.fit=lda(Direction~Lag1+Lag2,data=Smarket, subset=Year<2005)\nlda.fit\nplot(lda.fit, col=\"dodgerblue\")\nSmarket.2005=subset(Smarket,Year==2005) # Creating subset with 2005 data for prediction\nlda.pred=predict(lda.fit,Smarket.2005)\nnames(lda.pred)\nlda.class=lda.pred$class\nDirection.2005=Smarket$Direction[!train] \ntable(lda.class,Direction.2005) \ndata.frame(lda.pred)[1:5,]\ntable(lda.pred$class,Smarket.2005$Direction)\nmean(lda.pred$class==Smarket.2005$Direction)\n\n\n```\n\nThe best subset selection model will have the smallest training rss.\nThe stepwise selection models will have the smallest test rss. Between the forward and backward models, it will depend on the specific data being modeled. \n\n```{R}\nset.seed(123)\nx <- rnorm(100)\neps <- rnorm(100)\n\ny <- 4 + 9 * x + 2 * x^2 + x^3 + eps\n\nplot(x)\nplot(y)\n\nrequire(leaps)\n\nbest_subset <- regsubsets(y ~ poly(x, 10, raw = T), data = data.frame(y,x, nvmax = 10))\nbic <- summary(best_subset)$bic\ncp <- summary(best_subset)$cp\nadjr2 <- summary(best_subset)$adjr2\n\nplot(bic, type = \"b\", pch = 16, col = \"blue\", \n     xlab = \"Model Number\", ylab = \"BIC Value\", \n     main = \"BIC Values for Different Models\")\nplot(cp, type = \"b\", pch = 16, col = \"blue\", \n     xlab = \"Model Number\", ylab = \"Cp Value\", \n     main = \"Cp Values for Different Models\")\nplot(adjr2, type = \"b\", pch = 16, col = \"blue\", \n     xlab = \"Model Number\", ylab = \"Adjusted R^2 Value\", \n     main = \"Adjusted R^2 Values for Different Models\")\n\nwhich.min(bic)\nwhich.min(cp)\nwhich.max(adjr2)\n\ncoef(best_subset, id = 3)\n```\nThe best model is model 3 which has the lowest BIC value and Cp value. While model 7 has the maximum adjusted R squared value, the R squared plot begins to plateau at model 3, and I suspect overfitting to occur. \n\nThe coefficients for model 3 are 3.97, 8.92, 1.91, and 1.02 for the intercept, B1, B2, and B3 respectively.\n\n```{R}\nfor_subset <- regsubsets(y ~ poly(x, 10, raw = T), data = data.frame(y,x, nvmax = 10), method = \"forward\")\n\nplot(summary(for_subset)$bic, type = \"b\", pch = 16, col = \"blue\", \n     xlab = \"Model Number\", ylab = \"BIC Value\", \n     main = \"BIC Values for Different Models\")\nplot(summary(for_subset)$cp, type = \"b\", pch = 16, col = \"blue\", \n     xlab = \"Model Number\", ylab = \"Cp Value\", \n     main = \"Cp Values for Different Models\")\nplot(summary(for_subset)$adjr2, type = \"b\", pch = 16, col = \"blue\", \n     xlab = \"Model Number\", ylab = \"Adjusted R^2 Value\", \n     main = \"Adjusted R^2 Values for Different Models\")\n\nwhich.min(summary(for_subset)$bic)\nwhich.min(summary(for_subset)$cp)\nwhich.max(summary(for_subset)$adjr2)\n\n\ncoef(for_subset, id = 3)\n```\n\nThe best model is model 3 again with the lowest BIC and Cp values. Model 4 wins the best adjusted R squared value but model 3 has a similar adjusted R squared value according to the plot. \n\nThe coefficients for model 3 are 3.97, 8.92, 1.91, and 1.02 for the intercept, B1, B2, and B3 respectively. \n\n\n\n```{R}\nbac_subset <- regsubsets(y ~ poly(x, 10, raw = T), data = data.frame(y,x, nvmax = 10), method = \"backward\")\n\nplot(summary(bac_subset)$bic, type = \"b\", pch = 16, col = \"blue\", \n     xlab = \"Model Number\", ylab = \"BIC Value\", \n     main = \"BIC Values for Different Models\")\nplot(summary(bac_subset)$cp, type = \"b\", pch = 16, col = \"blue\", \n     xlab = \"Model Number\", ylab = \"Cp Value\", \n     main = \"Cp Values for Different Models\")\nplot(summary(bac_subset)$adjr2, type = \"b\", pch = 16, col = \"blue\", \n     xlab = \"Model Number\", ylab = \"Adjusted R^2 Value\", \n     main = \"Adjusted R^2 Values for Different Models\")\n\nwhich.min(summary(bac_subset)$bic)\nwhich.min(summary(bac_subset)$cp)\nwhich.max(summary(bac_subset)$adjr2)\n\ncoef(bac_subset, id = 3)\n```\n\nUsing the backwards stepwise selection method, model 4 performs the best on all 3 metrics. The coefficients are 3.96, 9.89, 1.97, and 0.17 for the intercept, B1, B2, and B3 respectively. \n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":false,"output-file":"assignment8.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.549","editor":"visual","theme":"zephyr","title":"Knowledge Mining (EPPS 6323)","subtitle":"Assignment 8","author":"Guan Chen","date":"last-modified","title-block-banner":true},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}