{
  "hash": "fc4fb05d3d42746692839ae436b93d42",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Knowledge Mining (EPPS 6323)\"\nsubtitle: \"Assignment 4\"\nauthor: \"Guan Chen\"\ndate: last-modified\ntoc: false\ntitle-block-banner: true\n---\n\n\n# Principal Components Analysis and Clustering Methods Workshop\n\n## Principal Components Analysis\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(datasets)\nlibrary(ISLR)\narrest = USArrests\nstates = row.names(USArrests)\nnames(USArrests)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Murder\"   \"Assault\"  \"UrbanPop\" \"Rape\"    \n```\n\n\n:::\n\n```{.r .cell-code}\napply(USArrests, 2, mean)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Murder  Assault UrbanPop     Rape \n   7.788  170.760   65.540   21.232 \n```\n\n\n:::\n\n```{.r .cell-code}\napply(USArrests, 2, var)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    Murder    Assault   UrbanPop       Rape \n  18.97047 6945.16571  209.51878   87.72916 \n```\n\n\n:::\n\n```{.r .cell-code}\npr.out=prcomp(USArrests, scale=TRUE)\nnames(pr.out)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"sdev\"     \"rotation\" \"center\"   \"scale\"    \"x\"       \n```\n\n\n:::\n\n```{.r .cell-code}\npr.out$center\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Murder  Assault UrbanPop     Rape \n   7.788  170.760   65.540   21.232 \n```\n\n\n:::\n\n```{.r .cell-code}\npr.out$scale\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Murder   Assault  UrbanPop      Rape \n 4.355510 83.337661 14.474763  9.366385 \n```\n\n\n:::\n\n```{.r .cell-code}\npr.out$rotation\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                PC1        PC2        PC3         PC4\nMurder   -0.5358995 -0.4181809  0.3412327  0.64922780\nAssault  -0.5831836 -0.1879856  0.2681484 -0.74340748\nUrbanPop -0.2781909  0.8728062  0.3780158  0.13387773\nRape     -0.5434321  0.1673186 -0.8177779  0.08902432\n```\n\n\n:::\n\n```{.r .cell-code}\ndim(pr.out$x)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 50  4\n```\n\n\n:::\n\n```{.r .cell-code}\npr.out$rotation=-pr.out$rotation\npr.out$x=-pr.out$x\nbiplot(pr.out, scale=0)\n```\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\npr.out$sdev\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.5748783 0.9948694 0.5971291 0.4164494\n```\n\n\n:::\n\n```{.r .cell-code}\npr.var=pr.out$sdev^2\npr.var\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2.4802416 0.9897652 0.3565632 0.1734301\n```\n\n\n:::\n\n```{.r .cell-code}\npve=pr.var/sum(pr.var)\npve\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.62006039 0.24744129 0.08914080 0.04335752\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(pve, xlab=\"Principal Component\", ylab=\"Proportion of Variance Explained\", ylim=c(0,1),type='b')\n```\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(cumsum(pve), xlab=\"Principal Component\", ylab=\"Cumulative Proportion of Variance Explained\", ylim=c(0,1),type='b')\n\nlibrary(factoextra)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: ggplot2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWelcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-1-3.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz(pr.out, \"ind\", geom = \"auto\", mean.point = TRUE, font.family = \"Georgia\")\n```\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-1-4.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz_pca_biplot(pr.out, font.family = \"Georgia\", col.var=\"firebrick1\")\n```\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-1-5.png){width=672}\n:::\n:::\n\n\n## K Means Clustering\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\ncomputers = read.csv(\"https://raw.githubusercontent.com/guru99-edu/R-Programming/master/computers.csv\") \n\n# Only retain two variables for illustration\nrescaled_comp <- computers[4:5] %>%\n  mutate(hd_scal = scale(hd),\n         ram_scal = scale(ram)) %>%\n  select(c(hd_scal, ram_scal))\n        \nggplot(data = rescaled_comp, aes(x = hd_scal, y = ram_scal)) +\n  geom_point(pch=20, col = \"blue\") + theme_bw() +\n  labs(x = \"Hard drive size (Scaled)\", y =\"RAM size (Scaled)\" ) +\n  theme(text = element_text(family=\"Georgia\")) \n```\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlibrary(animation)\nset.seed(2345)\nlibrary(animation)\n\n# Animate the K-mean clustering process, cluster no. = 4\nkmeans.ani(rescaled_comp[1:2], centers = 4, pch = 15:18, col = 1:4) \n```\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-2-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-2-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-2-5.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-2-6.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-2-7.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-2-8.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-2-9.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-2-10.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-2-11.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(iris, aes(Petal.Length, Petal.Width)) + geom_point() + \n  theme_bw() +\n  scale_color_manual(values=c(\"firebrick1\",\"forestgreen\",\"darkblue\"))\n```\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-2-12.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(iris, aes(Petal.Length, Petal.Width, color = Species)) + geom_point() + \n  theme_bw() +\n  scale_color_manual(values=c(\"firebrick1\",\"forestgreen\",\"darkblue\"))\n```\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-2-13.png){width=672}\n:::\n\n```{.r .cell-code}\nset.seed(20)\nirisCluster <- kmeans(iris[, 3:4], 3, nstart = 20)\nirisCluster\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nK-means clustering with 3 clusters of sizes 50, 48, 52\n\nCluster means:\n  Petal.Length Petal.Width\n1     1.462000    0.246000\n2     5.595833    2.037500\n3     4.269231    1.342308\n\nClustering vector:\n  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3\n [75] 3 3 3 2 3 3 3 3 3 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 2 2 2 2 2 3 2 2 2 2\n[112] 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2\n[149] 2 2\n\nWithin cluster sum of squares by cluster:\n[1]  2.02200 16.29167 13.05769\n (between_SS / total_SS =  94.3 %)\n\nAvailable components:\n\n[1] \"cluster\"      \"centers\"      \"totss\"        \"withinss\"     \"tot.withinss\"\n[6] \"betweenss\"    \"size\"         \"iter\"         \"ifault\"      \n```\n\n\n:::\n\n```{.r .cell-code}\nclass(irisCluster$cluster)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"integer\"\n```\n\n\n:::\n\n```{.r .cell-code}\ntable(irisCluster$cluster, iris$Species)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   \n    setosa versicolor virginica\n  1     50          0         0\n  2      0          2        46\n  3      0         48         4\n```\n\n\n:::\n\n```{.r .cell-code}\nirisCluster$cluster <- as.factor(irisCluster$cluster)\nggplot(iris, aes(Petal.Length, Petal.Width, color = irisCluster$cluster)) + geom_point() +\n  scale_color_manual(values=c(\"firebrick1\",\"forestgreen\",\"darkblue\")) +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-2-14.png){width=672}\n:::\n\n```{.r .cell-code}\nactual = ggplot(iris, aes(Petal.Length, Petal.Width, color = Species)) + geom_point() + \n  theme_bw() +\n  scale_color_manual(values=c(\"firebrick1\",\"forestgreen\",\"darkblue\")) +\n  theme(legend.position=\"bottom\") +\n  theme(text = element_text(family=\"Georgia\")) \nkmc = ggplot(iris, aes(Petal.Length, Petal.Width, color = irisCluster$cluster)) + geom_point() +\n  theme_bw() +\n  scale_color_manual(values=c(\"firebrick1\", \"darkblue\", \"forestgreen\")) +\n  theme(legend.position=\"bottom\") +\n  theme(text = element_text(family=\"Georgia\")) \nlibrary(grid)\nlibrary(gridExtra)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'gridExtra'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:dplyr':\n\n    combine\n```\n\n\n:::\n\n```{.r .cell-code}\ngrid.arrange(arrangeGrob(actual, kmc, ncol=2, widths=c(1,1)), nrow=1)\n```\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-2-15.png){width=672}\n:::\n\n```{.r .cell-code}\nlibrary(readr)\nwine <- read_csv(\"https://raw.githubusercontent.com/datageneration/gentlemachinelearning/master/data/wine.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 178 Columns: 14\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (14): class, Alcohol, Malic, Ash, Ash_alcalinity, Magnesium, Total_pheno...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\n## Choose and scale variables\nwine_subset <- scale(wine[ , c(2:4)])\n\n## Create cluster using k-means, k = 3, with 25 initial configurations\nwine_cluster <- kmeans(wine_subset, centers = 3,\n                       iter.max = 10,\n                       nstart = 25)\nwine_cluster\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nK-means clustering with 3 clusters of sizes 48, 60, 70\n\nCluster means:\n     Alcohol      Malic        Ash\n1  0.1470536  1.3907328  0.2534220\n2  0.8914655 -0.4522073  0.5406223\n3 -0.8649501 -0.5660390 -0.6371656\n\nClustering vector:\n  [1] 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 2 1 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2\n [38] 2 3 1 2 1 2 1 3 1 1 2 2 2 3 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 2 3 3 2 2 2\n [75] 3 3 3 3 3 1 3 3 3 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3\n[112] 3 1 3 3 3 3 3 1 3 3 2 1 1 1 3 3 3 3 1 3 1 3 1 3 3 1 1 1 1 1 2 1 1 1 1 1 1\n[149] 1 1 1 1 2 1 3 1 1 1 2 2 1 1 1 1 2 1 1 1 2 1 3 3 2 1 1 1 2 1\n\nWithin cluster sum of squares by cluster:\n[1]  73.71460  67.98619 111.63512\n (between_SS / total_SS =  52.3 %)\n\nAvailable components:\n\n[1] \"cluster\"      \"centers\"      \"totss\"        \"withinss\"     \"tot.withinss\"\n[6] \"betweenss\"    \"size\"         \"iter\"         \"ifault\"      \n```\n\n\n:::\n\n```{.r .cell-code}\nwssplot <- function(data, nc=15, seed=1234){\n  wss <- (nrow(data)-1)*sum(apply(data,2,var))\n  for (i in 2:nc){\n    set.seed(seed)\n    wss[i] <- sum(kmeans(data, centers=i)$withinss)}\n  plot(1:nc, wss, type=\"b\", xlab=\"Number of Clusters\",\n       ylab=\"Within groups sum of squares\")\n}\n\n# plotting values for each cluster starting from 1 to 9\nwssplot(wine_subset, nc = 9)\n```\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-2-16.png){width=672}\n:::\n\n```{.r .cell-code}\nwine_cluster$cluster = as.factor(wine_cluster$cluster)\npairs(wine[2:4],\n      col = c(\"firebrick1\", \"darkblue\", \"forestgreen\")[wine_cluster$cluster],\n      pch = c(15:17)[wine_cluster$cluster],\n      main = \"K-Means Clusters: Wine data\")\n```\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-2-17.png){width=672}\n:::\n\n```{.r .cell-code}\ntable(wine_cluster$cluster)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n 1  2  3 \n48 60 70 \n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(factoextra)\nfviz_nbclust(wine_subset, kmeans, method = \"wss\")\n```\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-2-18.png){width=672}\n:::\n\n```{.r .cell-code}\nwine.km <- eclust(wine_subset, \"kmeans\", nboot = 2)\n```\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-2-19.png){width=672}\n:::\n\n```{.r .cell-code}\nwine.km\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nK-means clustering with 3 clusters of sizes 60, 70, 48\n\nCluster means:\n     Alcohol      Malic        Ash\n1  0.8914655 -0.4522073  0.5406223\n2 -0.8649501 -0.5660390 -0.6371656\n3  0.1470536  1.3907328  0.2534220\n\nClustering vector:\n  [1] 1 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 3 1 3 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1\n [38] 1 2 3 1 3 1 3 2 3 3 1 1 1 2 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 1 2 2 1 1 1\n [75] 2 2 2 2 2 3 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n[112] 2 3 2 2 2 2 2 3 2 2 1 3 3 3 2 2 2 2 3 2 3 2 3 2 2 3 3 3 3 3 1 3 3 3 3 3 3\n[149] 3 3 3 3 1 3 2 3 3 3 1 1 3 3 3 3 1 3 3 3 1 3 2 2 1 3 3 3 1 3\n\nWithin cluster sum of squares by cluster:\n[1]  67.98619 111.63512  73.71460\n (between_SS / total_SS =  52.3 %)\n\nAvailable components:\n\n [1] \"cluster\"      \"centers\"      \"totss\"        \"withinss\"     \"tot.withinss\"\n [6] \"betweenss\"    \"size\"         \"iter\"         \"ifault\"       \"clust_plot\"  \n[11] \"silinfo\"      \"nbclust\"      \"data\"         \"gap_stat\"    \n```\n\n\n:::\n\n```{.r .cell-code}\nwine.km$nbclust\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3\n```\n\n\n:::\n\n```{.r .cell-code}\nfviz_nbclust(wine_subset, kmeans, method = \"gap_stat\")\n```\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-2-20.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz_silhouette(wine.km)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  cluster size ave.sil.width\n1       1   60          0.44\n2       2   70          0.33\n3       3   48          0.30\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-2-21.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz_cluster(wine_cluster, data = wine_subset) + \n  theme_bw() +\n  theme(text = element_text(family=\"Georgia\")) \n```\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-2-22.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz_cluster(wine_cluster, data = wine_subset, ellipse.type = \"norm\") + \n  theme_bw() +\n  theme(text = element_text(family=\"Georgia\")) \n```\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-2-23.png){width=672}\n:::\n:::\n\n\n## Hierarchical Clustering\n\n\n::: {.cell}\n\n```{.r .cell-code}\narrest.hc <- USArrests %>%\n  scale() %>%                    # Scale all variables\n  dist(method = \"euclidean\") %>% # Euclidean distance for dissimilarity \n  hclust(method = \"ward.D2\")     # Compute hierarchical clustering\n\n# Generate dendrogram using factoextra package\nfviz_dend(arrest.hc, k = 4, # Four groups\n          cex = 0.5, \n          k_colors = c(\"firebrick1\",\"forestgreen\",\"blue\", \"purple\"),\n          color_labels_by_k = TRUE, # color labels by groups\n          rect = TRUE, # Add rectangle (cluster) around groups,\n          main = \"Cluster Dendrogram: USA Arrest data\"\n) + theme(text = element_text(family=\"Georgia\")) \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: The `<scale>` argument of `guides()` cannot be `FALSE`. Use \"none\" instead as\nof ggplot2 3.3.4.\nℹ The deprecated feature was likely used in the factoextra package.\n  Please report the issue at <https://github.com/kassambara/factoextra/issues>.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](assignment4_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n**References**\n\nJames, Gareth, Daniela Witten, Trevor Hastie, and Robert Tibshirani. 2013 An introduction to statistical learning. Vol. 112. New York: Springer.\n\n\n\n",
    "supporting": [
      "assignment4_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}