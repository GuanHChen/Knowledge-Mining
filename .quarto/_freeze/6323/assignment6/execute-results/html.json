{
  "hash": "4652992d9c04e9ba69864035743e2e8e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Knowledge Mining (EPPS 6323)\"\nsubtitle: \"Assignment 6\"\nauthor: \"Guan Chen\"\ndate: last-modified\ntoc: false\ntitle-block-banner: true\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(ISLR)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: ISLR\n```\n\n\n:::\n\n```{.r .cell-code}\nrequire(MASS)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: MASS\n```\n\n\n:::\n\n```{.r .cell-code}\nrequire(descr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: descr\n```\n\n\n:::\n\n```{.r .cell-code}\nattach(Smarket)\n\n## Linear Discriminant Analysis\nfreq(Direction)\n```\n\n::: {.cell-output-display}\n![](assignment6_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nDirection \n      Frequency Percent\nDown        602   48.16\nUp          648   51.84\nTotal      1250  100.00\n```\n\n\n:::\n\n```{.r .cell-code}\ntrain = Year<2005\nlda.fit=lda(Direction~Lag1+Lag2,data=Smarket, subset=Year<2005)\nlda.fit\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\nlda(Direction ~ Lag1 + Lag2, data = Smarket, subset = Year < \n    2005)\n\nPrior probabilities of groups:\n    Down       Up \n0.491984 0.508016 \n\nGroup means:\n            Lag1        Lag2\nDown  0.04279022  0.03389409\nUp   -0.03954635 -0.03132544\n\nCoefficients of linear discriminants:\n            LD1\nLag1 -0.6420190\nLag2 -0.5135293\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(lda.fit, col=\"dodgerblue\")\n```\n\n::: {.cell-output-display}\n![](assignment6_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\nSmarket.2005=subset(Smarket,Year==2005) # Creating subset with 2005 data for prediction\nlda.pred=predict(lda.fit,Smarket.2005)\nnames(lda.pred)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"class\"     \"posterior\" \"x\"        \n```\n\n\n:::\n\n```{.r .cell-code}\nlda.class=lda.pred$class\nDirection.2005=Smarket$Direction[!train] \ntable(lda.class,Direction.2005) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         Direction.2005\nlda.class Down  Up\n     Down   35  35\n     Up     76 106\n```\n\n\n:::\n\n```{.r .cell-code}\ndata.frame(lda.pred)[1:5,]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     class posterior.Down posterior.Up         LD1\n999     Up      0.4901792    0.5098208  0.08293096\n1000    Up      0.4792185    0.5207815  0.59114102\n1001    Up      0.4668185    0.5331815  1.16723063\n1002    Up      0.4740011    0.5259989  0.83335022\n1003    Up      0.4927877    0.5072123 -0.03792892\n```\n\n\n:::\n\n```{.r .cell-code}\ntable(lda.pred$class,Smarket.2005$Direction)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      \n       Down  Up\n  Down   35  35\n  Up     76 106\n```\n\n\n:::\n\n```{.r .cell-code}\nmean(lda.pred$class==Smarket.2005$Direction)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.5595238\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(haven)\nTEDS_2016 <- read_stata(\"https://github.com/datageneration/home/blob/master/DataProgramming/data/TEDS_2016.dta?raw=true\")\n\nglm.vt <- glm(votetsai~female, data = TEDS_2016, family = binomial)\n\nsummary(glm.vt)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = votetsai ~ female, family = binomial, data = TEDS_2016)\n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  0.54971    0.08245   6.667 2.61e-11 ***\nfemale      -0.06517    0.11644  -0.560    0.576    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 1666.5  on 1260  degrees of freedom\nResidual deviance: 1666.2  on 1259  degrees of freedom\n  (429 observations deleted due to missingness)\nAIC: 1670.2\n\nNumber of Fisher Scoring iterations: 4\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(glm.vt)\n```\n\n::: {.cell-output-display}\n![](assignment6_files/figure-html/unnamed-chunk-1-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](assignment6_files/figure-html/unnamed-chunk-1-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](assignment6_files/figure-html/unnamed-chunk-1-5.png){width=672}\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n```\n\n::: {.cell-output-display}\n![](assignment6_files/figure-html/unnamed-chunk-1-6.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(TEDS_2016, aes(x = female, y = votetsai)) +\n  geom_bar(stat = \"identity\", fill = \"#1b98e0\") +\n  labs(title = \"Females Voting for Tsai\", x = \"Sex\", y = \"Votes\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 429 rows containing missing values or values outside the scale range\n(`geom_bar()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](assignment6_files/figure-html/unnamed-chunk-1-7.png){width=672}\n:::\n\n```{.r .cell-code}\nglm.vt <- glm(votetsai~female + KMT + DPP + age + edu + income, data = TEDS_2016, family = binomial)\n\nsummary(glm.vt)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = votetsai ~ female + KMT + DPP + age + edu + income, \n    family = binomial, data = TEDS_2016)\n\nCoefficients:\n             Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  1.618640   0.592084   2.734  0.00626 ** \nfemale       0.047406   0.177403   0.267  0.78930    \nKMT         -3.156273   0.250360 -12.607  < 2e-16 ***\nDPP          2.888943   0.267968  10.781  < 2e-16 ***\nage         -0.011808   0.007164  -1.648  0.09931 .  \nedu         -0.184604   0.083102  -2.221  0.02632 *  \nincome       0.013727   0.034382   0.399  0.68971    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 1661.76  on 1256  degrees of freedom\nResidual deviance:  836.15  on 1250  degrees of freedom\n  (433 observations deleted due to missingness)\nAIC: 850.15\n\nNumber of Fisher Scoring iterations: 6\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(glm.vt)\n```\n\n::: {.cell-output-display}\n![](assignment6_files/figure-html/unnamed-chunk-1-8.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](assignment6_files/figure-html/unnamed-chunk-1-9.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](assignment6_files/figure-html/unnamed-chunk-1-10.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](assignment6_files/figure-html/unnamed-chunk-1-11.png){width=672}\n:::\n\n```{.r .cell-code}\nglm.vt <- glm(votetsai~female + KMT + DPP + age + edu + income + Independence + Econ_worse + Govt_dont_care + Minnan_father + Mainland_father + Taiwanese, data = TEDS_2016, family = binomial)\n\nsummary(glm.vt)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = votetsai ~ female + KMT + DPP + age + edu + income + \n    Independence + Econ_worse + Govt_dont_care + Minnan_father + \n    Mainland_father + Taiwanese, family = binomial, data = TEDS_2016)\n\nCoefficients:\n                 Estimate Std. Error z value Pr(>|z|)    \n(Intercept)     -0.015976   0.679780  -0.024  0.98125    \nfemale          -0.097996   0.189840  -0.516  0.60571    \nKMT             -2.922246   0.259333 -11.268  < 2e-16 ***\nDPP              2.468855   0.275350   8.966  < 2e-16 ***\nage              0.003287   0.007884   0.417  0.67672    \nedu             -0.092110   0.090119  -1.022  0.30674    \nincome           0.021771   0.036406   0.598  0.54984    \nIndependence     1.020953   0.251776   4.055 5.01e-05 ***\nEcon_worse       0.310462   0.189100   1.642  0.10063    \nGovt_dont_care  -0.014295   0.188765  -0.076  0.93964    \nMinnan_father   -0.247650   0.253921  -0.975  0.32941    \nMainland_father -1.089332   0.396822  -2.745  0.00605 ** \nTaiwanese        0.909019   0.198930   4.570 4.89e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 1661.76  on 1256  degrees of freedom\nResidual deviance:  767.13  on 1244  degrees of freedom\n  (433 observations deleted due to missingness)\nAIC: 793.13\n\nNumber of Fisher Scoring iterations: 6\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(glm.vt)\n```\n\n::: {.cell-output-display}\n![](assignment6_files/figure-html/unnamed-chunk-1-12.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](assignment6_files/figure-html/unnamed-chunk-1-13.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](assignment6_files/figure-html/unnamed-chunk-1-14.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](assignment6_files/figure-html/unnamed-chunk-1-15.png){width=672}\n:::\n:::\n\nFemale voters are slightly less likely to vote for President Tsai, though whether or not a voter is female is a statistically insignificant predictor.\n\nThe best predictors for whether or not someone will vote for President Tsai include KMT, DPP, Independence, Mainland_father, and Taiwanese.\n\n\n\n",
    "supporting": [
      "assignment6_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}